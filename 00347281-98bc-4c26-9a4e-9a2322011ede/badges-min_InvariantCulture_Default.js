!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(2)),a=o(r(3)),l=o(r(4)),s=o(r(5)),c=o(r(6)),d=o(r(7)),p=new n.default;t.badge=p;var u=new a.default;t.helper=u;var i=new l.default;t.product=i;var h=new s.default;t.service=h;var g=new c.default;t.telemetry=g;var f=new d.default;t.validation=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0);!function(){var e=setInterval(function(){if(0!==$(o.helper.constants.selectMenuButton).length){var t=$(o.helper.constants.badgeLanguageSelectButton),r=$(o.helper.constants.badgeProductSelectButton),n=$(o.helper.constants.badgeSizeSelectButton);return o.helper.updateElementCSS($(o.helper.constants.selectMenuButton),{width:"100%"}),o.helper.updateElementCSS($(o.helper.constants.productUserDropdownBtn),{width:"270px"}),o.telemetry.stopDefaultTelemetry(t,r,n),o.badge.setBadgePreviewHeight(),clearInterval(e)}},100);o.badge.populateBadgePreview(),o.helper.updateElementCSS(o.helper.elements.productInputId,{height:"38px"});var t=window.location.hash.toLowerCase();Boolean(t)&&t===o.helper.constants.storeProductHashValue&&(o.helper.removeActiveElement(o.helper.elements.storeBadge),o.helper.displayActiveElement(o.helper.elements.storeProduct))}(),o.helper.elements.badgeSubmit.on("click",function(){o.validation.checkBadgeRequiredFields()&&(o.badge.generateBadge(),o.badge.setBadgePreviewHeight(),o.telemetry.sendTelemetry(awa.behavior.CLICK,o.helper.constants.clickLeft,{contentName:o.helper.elements.badgeSubmit.text(),contentType:o.helper.constants.button,language:o.helper.elements.selectLanguage.val(),product:o.helper.elements.selectProduct.val(),size:o.helper.elements.selectSize.val(),badgeId:o.helper.elements.inputStoreId.val()}))}),o.helper.elements.badgeCopy.on("click",function(){o.helper.copyToClipboard(o.helper.elements.badgeTextCode),o.telemetry.sendTelemetry(awa.behavior.COPY,o.helper.constants.clickLeft,{contentName:o.helper.elements.badgeCopy.text(),contentType:o.helper.constants.button})}),o.helper.elements.productGenerateBtn.on("click",function(){if(o.validation.checkProductRequiredFields()){o.product.showProductProgressLoader();var e=o.product.getProductRequestUrl();o.service.request(e,function(e){o.helper.elements.productCodeTextarea.val(e),o.helper.removeDisabledAttr(o.helper.elements.productCodeTextarea),o.helper.removeErrorMessage(o.helper.elements.productServerErrorMessage),o.helper.updateElementCSS(o.helper.elements.productPreviewContainer,{"background-color":"#ffffff"}),o.helper.elements.productPreviewItems.html(o.helper.constants.empty),o.helper.elements.productPreviewItems.html(e),o.helper.displayElements(o.helper.elements.productCopy,o.helper.elements.productGeneratedGlyph),o.product.hideProductProgressLoader()}),o.telemetry.sendTelemetry(awa.behavior.CLICK,o.helper.constants.clickLeft,{contentName:o.helper.elements.productGenerateBtn.text(),contentType:o.helper.constants.button,productId:o.helper.elements.productInputId.val(),size:o.helper.elements.productSizeSelect.val(),fallback:o.helper.elements.productFallbackSelect.val()})}}),o.helper.elements.productCopy.on("click",function(){o.helper.copyToClipboard(o.helper.elements.productCodeTextarea),o.telemetry.sendTelemetry(awa.behavior.COPY,o.helper.constants.clickLeft,{contentName:o.helper.elements.productCopy.text(),contentType:o.helper.constants.button})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=function(){function e(){}return e.prototype.createBadgeImg=function(e){return"<img class='c-image' src='"+$("#selectLanguage option[value='"+e+"']").data(o.helper.constants.large)+"' alt='"+$("#selectLanguage option[value='"+e+"']").data(o.helper.constants.alt)+"' />"},e.prototype.buildBadgeHTML=function(e){var t=o.helper.elements,r=t.badgeTextarea,n=t.badgeTextCode,a=t.badgeCopy,l=t.badgePreview,s=t.badgeGeneratedGlyph,c=t.badgePreviewWrapper,d=o.helper.constants,p=d.large,u=d.largeSizeStyle,i=d.smallSizeStyle,h=""+e.href+e.id+e.cid+e.ocid,g=e.size===p?e.srcLarge:e.srcSmall,f=e.alt,m=e.size===p?u:i,v="<a href='"+h+"' target='_blank'><img class='c-image' src='"+g+"' alt='"+f+"' style='"+m+"'/></a>",b="<a href='"+h+"'><img src='"+g+"' alt='"+f+"' style='"+m+"'/></a>";l.append(v),n.val(b),o.helper.displayElements(r,a,l,s),o.helper.updateElementCSS(c,{"background-color":"#ffffff"})},e.prototype.populateLanguageSelect=function(e){var t=[];o.helper.elements.selectLanguageOption.each(function(){var e=$(this).val();e!==o.helper.constants.empty&&t.push(e)}),$.inArray(e,t)===o.helper.constants.notFound&&(e=o.helper.constants.enUs),$("#selectLanguage option[value='"+e+"']").attr(o.helper.constants.selected,o.helper.constants.selected)},e.prototype.getBadgeData=function(){var e=o.helper.constants,t=e.attrSelected,r=e.large,n=e.small,a=e.alt,l=e.href,s=o.helper.elements,c=s.selectLanguage,d=s.selectProduct,p=s.selectSize,u=s.inputStoreId;return{srcLarge:c.find(t).data(r),srcSmall:c.find(t).data(n),alt:c.find(t).data(a),href:d.find(t).data(l),size:p.val(),id:u.val(),ocid:"&ocid=badge",cid:"?cid=storebadge"}},e.prototype.setBadgePreviewHeight=function(){var e=o.helper.elements,t=e.dataGridHeight,r=e.badgePreviewWrapper,n={"margin-top":"40px",height:t.outerHeight()-80+"px"};o.helper.updateElementCSS(r,n),$(window).resize(function(){var e={height:t.outerHeight()-40+"px"};o.helper.updateElementCSS(r,e)})},e.prototype.populateBadgePreview=function(){var e=window.location.pathname.toLowerCase().split("/").filter(Boolean)[0];this.populateLanguageSelect(e);var t=this.createBadgeImg(e);o.helper.elements.badgePreview.append(t)},e.prototype.generateBadge=function(){o.helper.elements.badgePreview.html(o.helper.constants.empty);var e=this.getBadgeData();this.buildBadgeHTML(e)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.constants={empty:"",red:"red",borderColor:"border-color",hiddenClass:"x-hidden",enUs:"en-us",small:"small",large:"large",href:"href",alt:"alt",selected:"selected",attrSelected:":selected",dataBiDnt:"data-bi-dnt",button:"button",badgeLanguageSelectButton:".badgeLanguageSelect button",badgeProductSelectButton:".badgeProductSelect button",badgeSizeSelectButton:".badgeSizeSelect button",selectMenuButton:"#badgePivot .c-select-menu button",productUserDropdownBtn:".productUserFields .c-select .c-select-menu button",largeSizeStyle:"width: 284px; height: 104px;",smallSizeStyle:"width: 127px; height: 52px;",clickLeft:"CL",keyboardEnter:"KS",storeIdLength:12,notFound:-1,disabled:"disabled",storeBadgeHashValue:"#store-badge",storeProductHashValue:"#store-product",activeClassName:"f-active"},this.elements={selectLanguage:$("#selectLanguage"),selectProduct:$("#selectProduct"),selectSize:$("#selectSize"),badgeSubmit:$("#badgeSubmit"),inputStoreId:$("#inputStoreId"),inputErrorMsg:$(".inputErrorMsg"),dataGridHeight:$(".dataGridHeight"),badgePreviewWrapper:$(".badgePreviewWrapper"),selectLanguageOption:$("#selectLanguage option"),badgePreview:$(".badgePreview"),badgeTextCode:$("#badgeTextCode"),badgeTextarea:$(".badgeTextarea"),badgeCopy:$("#badgeCopy"),badgeGeneratedGlyph:$(".badgeGeneratedGlyph"),productInputId:$("#productInputId"),productSizeSelect:$("#productSizeSelect"),productFallbackSelect:$("#productFallbackSelect"),productGenerateBtn:$("#productGenerateBtn"),productErrorMessage:$(".productErrorMessage"),productCodeTextarea:$("#productCodeTextarea"),productPreviewContainer:$("#productPreviewContainer"),productPreviewItems:$(".productPreviewItems"),productUserFields:$(".productUserFields"),productProgressIndicator:$(".productProgressIndicator"),productServerErrorMessage:$(".productServerErrorMessage"),productCopy:$("#productCopy"),productGeneratedGlyph:$(".productGeneratedGlyph"),storeBadge:$("#store-badge"),storeProduct:$("#store-product")}}return e.prototype.addErrorHighlight=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach(function(t){t.css(e.constants.borderColor,e.constants.red)})},e.prototype.removeErrorHighlight=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach(function(t){t.css(e.constants.borderColor,e.constants.empty)})},e.prototype.removeErrorMessage=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach(function(t){t.addClass(e.constants.hiddenClass)})},e.prototype.displayErrorMessage=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach(function(t){t.removeClass(e.constants.hiddenClass)})},e.prototype.displayElements=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach(function(t){t.removeClass(e.constants.hiddenClass)})},e.prototype.hideElements=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach(function(t){t.addClass(e.constants.hiddenClass)})},e.prototype.removeDisabledAttr=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach(function(t){t.prop(e.constants.disabled,!1)})},e.prototype.updateElementCSS=function(e,t){e.css(t)},e.prototype.copyToClipboard=function(e){e.select(),document.execCommand("copy")},e.prototype.displayActiveElement=function(e){e.addClass(this.constants.activeClassName)},e.prototype.removeActiveElement=function(e){e.removeClass(this.constants.activeClassName)},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=function(){function e(){}return e.prototype.getProductRequestUrl=function(){return"https://badgedelivery.microsoft.com/v1/badge/"+o.helper.elements.productInputId.val().trim()+"?type="+o.helper.elements.productSizeSelect.val()+"&fallback="+o.helper.elements.productFallbackSelect.val()},e.prototype.showProductProgressLoader=function(){o.helper.displayElements(o.helper.elements.productProgressIndicator)},e.prototype.hideProductProgressLoader=function(){o.helper.hideElements(o.helper.elements.productProgressIndicator)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=function(){function e(){}return e.prototype.request=function(e,t){$.ajax({type:"GET",url:encodeURI(e),success:function(e){t(e)},error:function(){o.helper.displayErrorMessage(o.helper.elements.productServerErrorMessage),o.product.hideProductProgressLoader()}})},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=function(){function e(){}return e.prototype.stopDefaultTelemetry=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach(function(e){e.attr(o.helper.constants.dataBiDnt,o.helper.constants.empty)})},e.prototype.sendTelemetry=function(e,t,r){var o={behavior:e,actionType:t,contentTags:r};awa.ct.captureContentPageAction(o)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=function(){function e(){}return e.prototype.checkBadgeRequiredFields=function(){var e=o.helper.elements,t=e.inputStoreId,r=e.inputErrorMsg;return o.helper.removeErrorHighlight(t),o.helper.removeErrorMessage(r),t.val().length===o.helper.constants.storeIdLength&&t.val()!==o.helper.constants.empty||(o.helper.addErrorHighlight(t),o.helper.displayErrorMessage(r),!1)},e.prototype.checkProductRequiredFields=function(){var e=o.helper.elements,t=e.productInputId,r=e.productErrorMessage;return o.helper.removeErrorHighlight(t),o.helper.removeErrorMessage(r),t.val()!==o.helper.constants.empty||(o.helper.displayErrorMessage(r),o.helper.addErrorHighlight(t),!1)},e}();t.default=n}]);